<div class="tiktok-app-container" id="tiktokAppContainer">

  <header class="tiktok-header" id="tiktokHeader">
    <div class="header-drag-area"></div>
    <div class="header-content">
      <div class="header-left">
      </div>

      <div class="header-right">
        <div class="window-controls">
          <button class="window-btn minimize-btn" id="tiktokMinBtn">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <rect width="10" height="1" x="1" y="6" />
            </svg>
          </button>
          <button class="window-btn maximize-btn" id="tiktokMaxBtn">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <rect width="9" height="9" x="1.5" y="1.5" fill="none" stroke="currentColor" stroke-width="1.5" />
            </svg>
          </button>
          <button class="window-btn close-btn" id="tiktokCloseBtn">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
              <path d="M1.5 1.5l9 9M10.5 1.5l-9 9" stroke="currentColor" stroke-width="1.5" fill="none" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </header>

  <aside class="tiktok-sidebar">
    <div class="sidebar-logo">
      <img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg" alt="Logo" class="logo-img">
    </div>

    <nav class="sidebar-nav">
      <div class="nav-item active" onclick="TikTokApp.nav('para-ti')">
        <span class="nav-icon">游</span> <span class="nav-text">Para ti</span>
      </div>
      <div class="nav-item" onclick="TikTokApp.nav('explorar')">
        <span class="nav-icon">游빐</span> <span class="nav-text">Explorar</span>
      </div>
      <div class="nav-item" onclick="TikTokApp.nav('siguiendo')">
        <span class="nav-icon">游논</span> <span class="nav-text">Siguiendo</span>
      </div>
    </nav>

    <div class="sidebar-footer">
      <p>춸 2025 TikTok Desktop</p>
    </div>
  </aside>

  <main class="tiktok-content">
    <div class="content-section active" id="section-para-ti">
      [mi_plantilla id="3410"]
    </div>

    <div class="content-section" id="section-explorar" style="display:none;">
      [mi_plantilla id="ID_PLANTILLA_EXPLORAR"]
    </div>

    <div class="content-section" id="section-siguiendo" style="display:none;">
      [mi_plantilla id="ID_PLANTILLA_SIGUIENDO"]
    </div>
  </main>

</div>

<style>
  /* ===== LAYOUT GRID (ESTILO SPOTIFY) ===== */
  :root {
    --tk-header-h: 50px;
    --tk-sidebar-w: 240px;
    --tk-bg: #000;
    --tk-sidebar-bg: #121212;
    --tk-text: #fff;
  }

  .tiktok-app-container {
    display: grid;
    grid-template-areas:
      "sidebar header"
      "sidebar content";
    grid-template-columns: var(--tk-sidebar-w) 1fr;
    grid-template-rows: var(--tk-header-h) minmax(0, 1fr);
    width: 100%;
    height: 100%;
    min-height: 0;
    background: var(--tk-bg);
    overflow: hidden;
  }

  /* HEADER */
  .tiktok-header {
    grid-area: header;
    background: rgba(18, 18, 18, 0.95);
    display: flex;
    align-items: center;
    position: relative;
    border-bottom: 1px solid #333;
    z-index: 100;
    -webkit-app-region: drag;
    /* Permite arrastre nativo si se soporta */
  }

  /* 츼rea de arrastre manual para el script de ventanas */
  .header-drag-area {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  .header-content {
    position: relative;
    z-index: 10;
    /* Encima del drag area */
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 15px;
  }

  /* SIDEBAR */
  .tiktok-sidebar {
    grid-area: sidebar;
    background: var(--tk-sidebar-bg);
    border-right: 1px solid #333;
    display: flex;
    flex-direction: column;
    padding: 20px 10px;
  }

  .sidebar-logo img {
    width: 120px;
    margin-bottom: 20px;
  }

  .nav-item {
    padding: 10px 15px;
    color: #ccc;
    cursor: pointer;
    border-radius: 4px;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: 0.2s;
  }

  .nav-item:hover,
  .nav-item.active {
    background: #2f2f2f;
    color: #fff;
    font-weight: bold;
  }

  /* CONTENIDO */
  .tiktok-content {
    grid-area: content;
    position: relative;
    overflow: hidden;
    /* El scroll lo maneja el hijo */
    background: #000;
    min-height: 0;
    height: 100%;
  }

  .content-section {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: hidden;
  }

  /* Fix para plantillas Elementor dentro de content-section */
  .content-section .elementor,
  .content-section .elementor-section-wrap,
  .content-section .elementor-section,
  .content-section .elementor-container,
  .content-section .elementor-row,
  .content-section .elementor-column,
  .content-section .elementor-column-wrap,
  .content-section .elementor-widget-wrap,
  .content-section .elementor-widget,
  .content-section .elementor-widget-container,
  .content-section .elementor-element {
    height: 100% !important;
    width: 100% !important;
    min-height: 0 !important;
    max-height: 100% !important;
    position: relative !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  .content-section .elementor-inner {
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    min-height: 0 !important;
  }

  .content-section .elementor-section-height-full,
  .content-section .elementor-section-height-min-height {
    min-height: 0 !important;
    height: 100% !important;
  }

  /* Asegurar que el contenedor del widget HTML ocupe todo */
  .content-section .elementor-widget-html,
  .content-section .elementor-widget-html .elementor-widget-container {
    height: 100% !important;
    width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    flex: 1 !important;
    min-height: 0 !important;
  }

  /* El div hijo directo del widget container debe ocupar todo */
  .content-section .elementor-widget-container>div {
    height: 100% !important;
    width: 100% !important;
    min-height: 0 !important;
    position: relative !important;
  }

  /* CONTROLES VENTANA */
  .window-controls {
    display: flex;
    gap: 8px;
  }

  .window-btn {
    background: transparent;
    border: none;
    color: #fff;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .window-btn:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  .close-btn:hover {
    background: #E81123;
  }

  /* RESPONSIVE */
  @media (max-width: 800px) {
    .tiktok-app-container {
      grid-template-columns: 60px 1fr;
    }

    .tiktok-sidebar {
      padding: 10px 5px;
      align-items: center;
    }

    .sidebar-logo img {
      display: none;
    }

    .nav-text {
      display: none;
    }
  }
</style>

<script>
  (function () {
    // Navegaci칩n interna
    window.TikTokApp = {
      nav: function (sectionId) {
        document.querySelectorAll('.content-section').forEach(el => el.style.display = 'none');
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));

        const target = document.getElementById('section-' + sectionId);
        if (target) target.style.display = 'block';

        // Activar clase en men칰 (simple logic)
        event.currentTarget.classList.add('active');
      }
    };

    // Conectar botones de ventana
    setTimeout(() => {
      const win = document.getElementById('tiktokAppContainer').closest('.app-window');
      if (!win) return;

      // Asumimos que el ID de la ventana es 'tiktok-window' o el ID del div padre
      const winId = win.id;

      document.getElementById('tiktokMinBtn').onclick = () => window.minimizeWindowGlobal(winId);

      document.getElementById('tiktokMaxBtn').onclick = () => {
        // L칩gica simple de toggle maximize
        if (win.classList.contains('maximized')) {
          win.classList.remove('maximized');
        } else {
          win.classList.add('maximized');
        }
      };

      document.getElementById('tiktokCloseBtn').onclick = () => {
        // Cerrar y remover de taskbar
        win.classList.remove('show');
        window.removeFromTaskbarGlobal(winId);
      };

      // Pasar evento de drag al header
      const dragArea = document.querySelector('#tiktokHeader .header-drag-area');
      // (Aqu칤 asumo que tu sistema de ventanas usa una clase .window-drag-area para iniciar el arrastre)
      // Si tu sistema usa una l칩gica espec칤fica, aseg칰rate que este div la active.

    }, 1000);
  })();
</script>